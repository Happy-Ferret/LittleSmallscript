<!DOCTYPE html>
<html>
    <head>
      <title>Little Smallscript</title>
      <script src="packratparser.js"></script>
      <script src="littleparsers.js"></script>
      <script src="blockparser.js"></script>
      <script src="optimization.js"></script>
      <script src="expressionparser.js"></script>
      <script src="statementparser.js"></script>
      <script src="littlesmallscript.js"></script>
      <script src="littlesmallmethods.js"></script>
      <script src="../lib/beautify.js"></script>
      <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
      <style>
        textarea.source {
          width: 90%;
          height: 20em;
        }
        .error {
          background-color: #FF9A95;
        }
      </style>
    </head>
    <body>
      <div id="container">
        <div>
          <p class="error"></p><br />
          <textarea id="lss" class="source"></textarea>
        </div>
        <div>
          <textarea id="js" class="source" disabled></textarea>
        </div>
        <div><button id="_eval-btn">run</button></div>
        <div>
          <textarea id="console" class="source" disabled></textarea>
        </div>
      </div>

      <script type="text/javascript">
        (function () {
          var edited = false;
          var compile_writeAt_ = function (txt, jQ) {
            $('.error').text('');
            try {
              var js = new LittleSmallscript(txt, {prettyprint: true, optimization: true}).toJS();
            } catch (err) {
              $('.error').text(err);
            }
            jQ.text(js);
            return js;
          };
          $(function () {
            $('#lss').on('keyup', function () {
              return compile_writeAt_($('#lss').val(), $('#js'));
            });
            $('#_eval-btn').click(function () {
              var js, res;
              js = compile_writeAt_($('#lss').val(), $('#js'));
              try {
                res = eval(js);
              } catch (err) {
                res = err.type;
              }
              $('#console').text(JSON.stringify(res));
            });
          });
      }).call(this);
    </script>
    </body>
</html>
